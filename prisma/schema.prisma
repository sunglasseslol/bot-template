// Prisma schema for Discord Bot Template
// This file defines the database structure using Prisma ORM

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Example: User model to store Discord user information
// You can extend this schema with additional models as needed
model User {
  id            String   @id @default(cuid()) // Internal ID
  discordId     String   @unique // Discord user ID
  username      String
  discriminator String?  // Discord discriminator (may be null for new users)
  avatar        String?  // Avatar hash
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // Add relationships here as needed
  // Example: posts Post[]

  @@map("users")
}

// Example: Guild (Server) model
model Guild {
  id        String   @id @default(cuid())
  discordId String   @unique // Discord guild ID
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relationships
  guildEvents   GuildEvent[]

  @@map("guilds")
}

// Guild events tracking (join/leave, member events)
model GuildEvent {
  id        String   @id @default(cuid())
  guildId   String
  eventType String   // "guild_join", "guild_leave", "member_join", "member_leave", etc.
  userId    String?  // Discord user ID (for member events)
  metadata  String?  // JSON metadata
  createdAt DateTime @default(now())

  // Relationships
  guild Guild @relation(fields: [guildId], references: [id], onDelete: Cascade)

  @@index([guildId])
  @@index([eventType])
  @@index([createdAt])
  @@map("guild_events")
}

